<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KhasmShop | Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap');
        body { font-family: 'Cairo', sans-serif; background: #fff; margin: 0; }
        .royal-bg { position: fixed; inset: 0; z-index: -1; background: linear-gradient(135deg, #ffffff 0%, #f0fff4 30%, #fff5f5 60%, #fffdf0 100%); }
        
        /* Ø§Ù†ØªØ±Ùˆ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #intro-screen { position: fixed; inset: 0; z-index: 9999; background: #000; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.8s; }
        .logo-glow { font-size: 3rem; font-weight: 900; color: #fff; text-shadow: 0 0 20px #2563eb; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.8; } }

        /* Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø«Ù„Ø§Ø«ÙŠØ© */
        .m-container { border-bottom: 2px solid #eee; overflow: hidden; background: #fff; }
        .m-row { white-space: nowrap; padding: 6px 0; font-size: 10px; font-weight: 900; color: #fff; display: block; }
        .m-blue { background: #1e40af; animation: slideL 20s linear infinite; }
        .m-red { background: #991b1b; animation: slideR 25s linear infinite; }
        .m-green { background: #065f46; animation: slideL 30s linear infinite; }
        @keyframes slideL { from { transform: translateX(100%); } to { transform: translateX(-100%); } }
        @keyframes slideR { from { transform: translateX(-100%); } to { transform: translateX(100%); } }

        /* Ø§Ù„ÙƒØ±ÙˆØª */
        .p-card { background: #fff; border-radius: 20px; padding: 15px; text-align: center; border: 1px solid #f0f0f0; box-shadow: 0 4px 6px rgba(0,0,0,0.02); transition: 0.3s; }
        .p-card:hover { transform: translateY(-5px); border-color: #fbbf24; }
        .p-img { width: 60px; height: 60px; margin: 0 auto 10px; border-radius: 12px; }
        
        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div class="royal-bg"></div>

    <div id="intro-screen">
        <div class="logo-glow italic mb-10">KHASM<span class="text-blue-500">SHOP</span></div>
        <button onclick="login()" class="bg-white text-black px-10 py-4 rounded-2xl font-black flex items-center gap-3 shadow-2xl active:scale-95 transition">
            <img src="https://www.google.com/favicon.ico" class="w-5"> Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Google Play
        </button>
    </div>

    <div id="app" class="hidden">
        <div class="m-container">
            <div class="m-row m-blue">ğŸ”¥ Ø®ØµÙ… 5% Ø¹Ù„Ù‰ ÙƒØ§ÙØ© Ø¹Ø±ÙˆØ¶ Ø´Ø¯Ø§Øª Ø¨Ø¨Ø¬ÙŠ | Ø´Ø­Ù† ÙÙˆØ±ÙŠ ÙˆØ¢Ù…Ù† Ø¹Ø¨Ø± Ø§Ù„Ø¢ÙŠØ¯ÙŠ ğŸ”¥</div>
            <div class="m-row m-red">âš¡ Ø±ÙˆÙ… ÙƒÙ„ Ø£Ø³Ø¨ÙˆØ¹ Ø¹Ù„Ù‰ 60 US | Ø´Ø§Ø±Ùƒ Ø§Ù„Ø¢Ù† ÙˆÙƒÙ† Ø§Ù„ÙØ§Ø¦Ø² ÙÙŠ Ø±ÙˆÙ…Ø§ØªÙ†Ø§ Ø§Ù„Ù…Ù„ÙƒÙŠØ© âš¡</div>
            <div class="m-row m-green">ğŸ’ Ø­Ø²Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª ÙˆØ§Ù„ÙƒØ±Ø³ØªØ§Ù„Ø§Øª Ù…ØªÙˆÙØ±Ø© Ø§Ù„Ø¢Ù† Ø¨Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ÙÙŠ Ø§Ù„Ø³ÙˆØ¯Ø§Ù† ğŸ’</div>
        </div>

        <header class="p-4 flex justify-between items-center bg-white/70 backdrop-blur-md sticky top-0 z-50 border-b">
            <div class="flex items-center gap-3">
                <img id="uImg" class="w-12 h-12 rounded-2xl border-2 border-yellow-500 shadow-md" src="">
                <div>
                    <p id="uName" class="font-black text-sm text-slate-800">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„..</p>
                    <p id="uID" class="text-[10px] text-blue-600 font-bold bg-blue-50 px-2 rounded italic">Ù…Ø­ÙØ¸Ø©: #------</p>
                </div>
            </div>
            <div class="text-left">
                <p class="text-[9px] font-bold text-gray-400">Ø§Ù„Ø±ØµÙŠØ¯</p>
                <p id="uBal" class="font-black text-xs text-green-600">0 Ø¬.Ø³</p>
            </div>
        </header>

        <main class="max-w-md mx-auto p-4 pb-20">
            <h3 class="font-black text-slate-800 mb-4 flex items-center gap-2">
                <span class="w-2 h-6 bg-yellow-500 rounded-full"></span> Ø´Ø¯Ø§Øª Ø¨Ø¨Ø¬ÙŠ (Ø´Ø­Ù† Ù…Ø¨Ø§Ø´Ø±)
            </h3>
            <div class="grid grid-cols-2 gap-4 mb-8">
                <div class="p-card">
                    <img class="p-img" src="https://www.pubgmobile.com/common/images/icon_logo.jpg">
                    <p class="font-black text-[11px]">60 US</p>
                    <p class="text-blue-600 font-black text-xs">4,000 Ø¬.Ø³</p>
                    <button onclick="openOrder('60 US', 4000)" class="w-full bg-slate-900 text-white py-2 rounded-xl text-[9px] font-black mt-2">Ø·Ù„Ø¨ Ø´Ø­Ù†</button>
                </div>
                <div class="p-card">
                    <img class="p-img" src="https://www.pubgmobile.com/common/images/icon_logo.jpg">
                    <p class="font-black text-[11px]">325 US</p>
                    <p class="text-blue-600 font-black text-xs">20,000 Ø¬.Ø³</p>
                    <button onclick="openOrder('325 US', 20000)" class="w-full bg-slate-900 text-white py-2 rounded-xl text-[9px] font-black mt-2">Ø·Ù„Ø¨ Ø´Ø­Ù†</button>
                </div>
                <div class="p-card">
                    <img class="p-img" src="https://www.pubgmobile.com/common/images/icon_logo.jpg">
                    <p class="font-black text-[11px]">660 US</p>
                    <p class="text-blue-600 font-black text-xs">40,000 Ø¬.Ø³</p>
                    <button onclick="openOrder('660 US', 40000)" class="w-full bg-slate-900 text-white py-2 rounded-xl text-[9px] font-black mt-2">Ø·Ù„Ø¨ Ø´Ø­Ù†</button>
                </div>
                <div class="p-card">
                    <img class="p-img" src="https://www.pubgmobile.com/common/images/icon_logo.jpg">
                    <p class="font-black text-[11px]">1800 US</p>
                    <p class="text-blue-600 font-black text-xs">100,000 Ø¬.Ø³</p>
                    <button onclick="openOrder('1800 US', 100000)" class="w-full bg-slate-900 text-white py-2 rounded-xl text-[9px] font-black mt-2">Ø·Ù„Ø¨ Ø´Ø­Ù†</button>
                </div>
            </div>

            <h3 class="font-black text-slate-800 mb-4 flex items-center gap-2">
                <span class="w-2 h-6 bg-blue-500 rounded-full"></span> Ø­Ø²Ù…Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª (Ø¹Ø¨Ø± Ø§Ù„Ø¢ÙŠØ¯ÙŠ)
            </h3>
            <div class="space-y-3 mb-8">
                <div onclick="openOrder('Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ø±Ø§ÙŠÙ… Ø´Ù‡Ø±', 4500)" class="flex justify-between items-center bg-white p-4 rounded-2xl border border-gray-100 shadow-sm">
                    <span class="font-black text-xs">Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ø±Ø§ÙŠÙ… Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯ ğŸ’«</span>
                    <span class="text-blue-600 font-black text-xs text-left">4,500 Ø¬.Ø³</span>
                </div>
                <div onclick="openOrder('Ø¨Ø±Ø§ÙŠÙ… Ø¨Ù„Øµ Ø´Ù‡Ø±', 45000)" class="flex justify-between items-center bg-white p-4 rounded-2xl border border-gray-100 shadow-sm">
                    <span class="font-black text-xs">Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ø±Ø§ÙŠÙ… Ø¨Ù„Øµ Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯ ğŸ’«</span>
                    <span class="text-blue-600 font-black text-xs text-left">45,000 Ø¬.Ø³</span>
                </div>
                <div onclick="openOrder('Ø­Ø²Ù…Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ Ø§Ù„Ø£ÙˆÙ„Ù‰', 10000)" class="flex justify-between items-center bg-white p-4 rounded-2xl border border-gray-100 shadow-sm">
                    <span class="font-black text-xs">Ø­Ø²Ù…Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ Ø§Ù„Ø£ÙˆÙ„Ù‰ ğŸ’«</span>
                    <span class="text-blue-600 font-black text-xs text-left">10,000 Ø¬.Ø³</span>
                </div>
                <div onclick="openOrder('Ø­Ø²Ù…Ø© Ø§Ù„Ù…ØªØ±ÙŠÙ„Ø§Øª', 13500)" class="flex justify-between items-center bg-white p-4 rounded-2xl border border-gray-100 shadow-sm">
                    <span class="font-black text-xs">Ø­Ø²Ù…Ø© Ø§Ù„Ù…ØªØ±ÙŠÙ„Ø§Øª ğŸ’«</span>
                    <span class="text-blue-600 font-black text-xs text-left">13,500 Ø¬.Ø³</span>
                </div>
            </div>

            <div class="p-6 bg-slate-900 rounded-[30px] text-white">
                <h4 class="font-black mb-2 italic">Ù…Ù† Ù†Ø­Ù†ØŸ</h4>
                <p class="text-[10px] leading-loose opacity-80">
                    Ù‡Ø°Ø§ Ù…Ù† Ø°ÙˆÙ‚Ùƒ Ø§Ù„Ø±Ø§Ù‚ÙŠ Ø§Ù„ÙØ®Ù… Ø§Ø®ØªÙŠØ§Ø± Ù…ØªØ¬Ø± "Ø®ØµÙ… Ø´ÙˆØ¨". Ù†Ø­Ù† Ù†ÙˆÙØ± Ù„Ùƒ Ø´Ø­Ù† Ø´Ø¯Ø§Øª Ø¨Ø¨Ø¬ÙŠ ÙˆØ§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø¨Ø£Ø±Ø®Øµ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ù…Ø¹ Ù†Ø¸Ø§Ù… Ù†Ù‚Ø§Ø· Ù…Ù„ÙƒÙŠ ÙˆØ±ÙˆÙ…Ø§Øª Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©. Ù…Ø­ÙØ¸ØªÙƒ Ø«Ø§Ø¨ØªØ© ÙˆØ£Ù…Ø§Ù†Ùƒ Ø£ÙˆÙ„ÙˆÙŠØªÙ†Ø§.
                </p>
            </div>
        </main>
    </div>

    <div id="orderModal" class="fixed inset-0 z-[6000] bg-black/60 backdrop-blur-sm flex items-end justify-center hidden">
        <div class="w-full max-w-md bg-white rounded-t-[40px] p-8">
            <h3 class="font-black text-xl text-center mb-6" id="mTitle">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</h3>
            <input id="gID" type="number" placeholder="Ø£Ø¯Ø®Ù„ Ø£ÙŠØ¯ÙŠ Ø§Ù„Ù„Ø§Ø¹Ø¨ (ID)" class="w-full bg-gray-50 p-4 rounded-2xl mb-4 font-bold outline-none border text-center">
            <input id="gName" type="text" placeholder="Ø§Ø³Ù…Ùƒ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©" class="w-full bg-gray-50 p-4 rounded-2xl mb-4 font-bold outline-none border text-center">
            <div class="p-4 bg-yellow-50 rounded-2xl text-[10px] font-bold text-yellow-800 mb-6 text-center italic italic">ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø¯ÙØ¹: Ù…Ø­ÙØ¸Ø© Ø®ØµÙ… Ø´ÙˆØ¨</div>
            <button onclick="confirmOrder()" class="w-full bg-slate-900 text-white py-5 rounded-2xl font-black shadow-xl">ØªØ£ÙƒÙŠØ¯ ÙˆØ¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…ØªØ¬Ø± ğŸš€</button>
            <button onclick="closeModal()" class="w-full py-2 text-gray-400 font-bold text-xs mt-2">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = { apiKey: "AIzaSyC0jzecEwKgHpxHpTi8Y-_bwwfzVdtgf3E", authDomain: "khasmshop.firebaseapp.com", projectId: "khasmshop", storageBucket: "khasmshop.firebasestorage.app", messagingSenderId: "238182001615", appId: "1:238182001615:web:d77391030a40a481b440ba" };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const prov = new GoogleAuthProvider();

        let userData = null;
        let activePrice = 0;

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                document.getElementById('intro-screen').style.transform = "translateY(-100%)";
                setTimeout(() => {
                    document.getElementById('app').classList.remove('hidden');
                    document.getElementById('intro-screen').classList.add('hidden');
                }, 800);
                initUser(user);
            }
        });

        async function initUser(user) {
            const ref = doc(db, "users", user.uid);
            onSnapshot(ref, (snap) => {
                if (snap.exists()) {
                    userData = snap.data();
                    document.getElementById('uName').innerText = userData.name;
                    document.getElementById('uImg').src = userData.img;
                    document.getElementById('uID').innerText = `Ù…Ø­ÙØ¸Ø©: #${userData.walletID}`;
                    document.getElementById('uBal').innerText = userData.balance.toLocaleString() + " Ø¬.Ø³";
                } else {
                    const wid = Math.floor(100000 + Math.random() * 900000).toString();
                    setDoc(ref, { name: user.displayName, walletID: wid, balance: 0, points: 0, img: user.photoURL });
                }
            });
        }

        window.login = () => signInWithPopup(auth, prov);
        window.openOrder = (t, price) => { 
            activePrice = price;
            document.getElementById('mTitle').innerText = t; 
            document.getElementById('orderModal').classList.remove('hidden'); 
        };
        window.closeModal = () => document.getElementById('orderModal').classList.add('hidden');
        window.confirmOrder = async () => {
            const id = document.getElementById('gID').value;
            const name = document.getElementById('gName').value;
            if(!id || !name) return alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§Ù…Ù„Ø©!");
            
            await addDoc(collection(db, "orders"), {
                uid: auth.currentUser.uid,
                uName: userData.name,
                wallet: userData.walletID,
                product: document.getElementById('mTitle').innerText,
                gameID: id,
                gameName: name,
                price: activePrice,
                status: 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°',
                date: new Date().toLocaleString('ar-EG')
            });
            alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©ØŒ Ø³ÙŠØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ° Ø®Ù„Ø§Ù„ Ø¯Ù‚Ø§Ø¦Ù‚!");
            closeModal();
        };
    </script>
</body>
</html>

