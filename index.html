<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KHASM SHOP 6.0 | Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠØ©</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
:root{
--main-bg:linear-gradient(135deg,#0f172a,#1e293b,#0f172a);
--accent:#10b981;
}
body{font-family:'Cairo',sans-serif;background:var(--main-bg);color:#f1f5f9;overflow-x:hidden;min-height:100vh;scroll-behavior:smooth}

/* Splash Screen */
#splash-screen{position:fixed;inset:0;z-index:1000;background:radial-gradient(circle at center,#020617 0%,#000 100%);display:flex;flex-direction:column;align-items:center;justify-content:center;transition:opacity 1s ease;overflow:hidden}
.stars{position:absolute;width:100%;height:100%;background:url('https://i.ibb.co/vXHJxzn/stars.png') repeat;animation:starsMove 60s linear infinite}
@keyframes starsMove{0%{background-position:0 0}100%{background-position:-10000px 0}}
.loader-ring{width:120px;height:120px;border:4px solid transparent;border-top-color:var(--accent);border-radius:50%;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* Cards */
.royal-card{background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);border-radius:20px;box-shadow:0 10px 25px -5px rgba(0,0,0,0.3);transition:transform 0.3s,box-shadow 0.3s;cursor:pointer}
.royal-card:hover{transform:translateY(-5px) scale(1.02);box-shadow:0 15px 35px -5px rgba(0,0,0,0.5)}
.ad-card{background:linear-gradient(135deg,#2563eb,#10b981);border-radius:20px;padding:12px;color:#fff;font-weight:bold;box-shadow:0 8px 20px -5px rgba(0,0,0,0.4);transition:transform 0.3s;cursor:pointer}
.ad-card:hover{transform:scale(1.03);}

/* News Slider */
.news-slider{background:rgba(30,41,59,0.85);color:#fff;padding:12px 0;overflow:hidden;position:relative}
.news-track{display:flex;gap:60px;animation:scroll 35s linear infinite;white-space:nowrap}
@keyframes scroll{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}

/* Sidebar */
#sidebar{position:fixed;top:0;right:-320px;width:300px;height:100%;background:rgba(30,41,59,0.95);backdrop-filter:blur(12px);z-index:900;transition:right 0.4s;padding:20px;overflow-y:auto}
#sidebar.show{right:0}
#sidebar button{width:100%;margin-bottom:12px}

/* Hamburger */
#hamburger{position:fixed;top:20px;right:20px;z-index:950;font-size:2rem;color:white;cursor:pointer}

/* Buttons */
.btn-google{background:#fff;color:#444;border:1px solid #ddd}
.btn-phone{background:#2563eb;color:#fff}

/* Modal Request Details */
#request-modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.8);z-index:1000}
#request-modal .modal-content{background:rgba(255,255,255,0.05);backdrop-filter:blur(12px);padding:20px;border-radius:20px;width:90%;max-width:400px;color:#fff}
</style>
</head>
<body>

<!-- Splash Screen -->
<div id="splash-screen">
  <div class="stars"></div>
  <div class="loader-ring mb-8"></div>
  <h1 class="text-4xl font-black text-white tracking-widest animate-pulse">KHASM <span class="text-emerald-500">SHOP</span></h1>
  <p class="text-emerald-400 mt-4 font-bold tracking-widest text-sm">LOADING EMPIRE 6.0...</p>
</div>

<!-- Auth Page -->
<div id="auth-page" class="hidden fixed inset-0 z-[500] bg-slate-900/90 flex items-center justify-center p-6">
  <div class="bg-white/10 rounded-[40px] p-8 w-full max-w-md text-center backdrop-blur-md shadow-2xl">
    <div class="w-20 h-20 bg-blue-600 rounded-3xl mx-auto mb-6 flex items-center justify-center text-white text-3xl shadow-lg shadow-blue-200">
      <i class="fas fa-shield-crown"></i>
    </div>
    <h2 class="text-2xl font-black text-white mb-2">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù„ÙƒÙŠ</h2>
    <p class="text-slate-300 text-sm mb-8">Ø§Ø®ØªØ± ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø¨Ø¯Ø¡ ÙÙŠ Ø§Ù„Ø´Ø­Ù†</p>
    <button onclick="loginWithGoogle()" class="w-full btn-google py-4 rounded-2xl font-bold mb-4 flex items-center justify-center gap-3 shadow-sm hover:scale-105 transition-transform">
      <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/action/google.svg" width="20"> Google
    </button>
    <button onclick="showPhoneLogin()" class="w-full btn-phone py-4 rounded-2xl font-bold flex items-center justify-center gap-3 shadow-lg shadow-blue-200 hover:scale-105 transition-transform">
      <i class="fas fa-phone-alt"></i> Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (OTP)
    </button>
  </div>
</div>

<!-- Hamburger Icon -->
<div id="hamburger" onclick="openSidebar()"><i class="fas fa-bars"></i></div>

<!-- Sidebar -->
<div id="sidebar">
  <button onclick="closeSidebar()" class="text-white text-right mb-6"><i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚</button>
  <p class="font-bold text-lg mb-2">Ø§Ù„Ø­Ø³Ø§Ø¨</p>
  <p id="userPhone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: -</p>
  <hr class="my-2 border-slate-400">
  <p class="font-bold text-lg mt-4 mb-2">Ø§Ù„Ø·Ù„Ø¨Ø§Øª</p>
  <div id="userOrders" class="space-y-2"></div>
  <hr class="my-2 border-slate-400">
  <p class="font-bold text-lg mt-4 mb-2">Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ù†Ù‚Ø§Ø·</p>
  <div id="redeemPoints" class="space-y-2"></div>
  <hr class="my-2 border-slate-400">
  <p class="font-bold text-lg mt-4 mb-2">Ù…Ù† Ù†Ø­Ù†</p>
  <p>KHASM SHOP Ù…ØªØ¬Ø± Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø§Ù„Ø£Ø³Ø±Ø¹ ÙˆØ§Ù„Ø£Ø¬Ù…Ù„ØŒ ØªØ¬Ø±Ø¨Ø© ÙØ®Ù…Ø© Ù…Ø¹ ØªØµÙ…ÙŠÙ… Ø­Ø¯ÙŠØ« ÙˆÙ…Ø¤Ø«Ø±Ø§Øª Ø±Ø§Ø¦Ø¹Ø© ğŸ’ğŸ”¥ğŸ</p>
  <hr class="my-2 border-slate-400">
  <button onclick="logout()" class="bg-red-500 text-white py-2 rounded-xl mt-4">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨ / ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
</div>

<!-- News Slider -->
<div class="news-slider">
  <div class="news-track font-bold text-xs uppercase">
    <span>ğŸ”¥ Ø§Ø´Ø­Ù† 5000 Ø´Ø¯Ø© ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ 1000 Ù…Ø¬Ø§Ù†Ø§Ù‹!</span>
    <span>ğŸ’ Ø¬ÙˆØ§Ù‡Ø± Ù…ØªÙˆÙØ±Ø© Ø¨Ø£Ø³Ø¹Ø§Ø± Ø³ÙˆØ¯Ø§Ù†ÙŠØ©!</span>
    <span>ğŸš€ Ø§Ù„Ø´Ø­Ù† Ø®Ù„Ø§Ù„ 5 Ø¯Ù‚Ø§Ø¦Ù‚!</span>
    <span>ğŸ Ø§Ø³ØªØ¨Ø¯Ù„ 30 Ù†Ù‚Ø·Ø© Ø¨Ù€ 4000 Ø¬.Ø³ ÙÙˆØ±Ø§Ù‹!</span>
    <span>âš ï¸ ØªØ£ÙƒØ¯ Ù…Ù† ID Ù‚Ø¨Ù„ Ø§Ù„Ø·Ù„Ø¨!</span>
    <span>ğŸ‘‘ Ø§Ù†Ø¶Ù… Ù„Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù‡Ø¯ÙŠØ©!</span>
    <span>ğŸ’¥ Ø¹Ø±Ø¶ Ø®Ø§Øµ: 100 Ø´Ø¯Ø© Ø¥Ø¶Ø§ÙÙŠØ© Ù„ÙƒÙ„ Ø·Ù„Ø¨ Ø§Ù„ÙŠÙˆÙ…!</span>
    <span>ğŸ‰ Ø®ØµÙ… Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø­Ù†Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©!</span>
    <span>ğŸ”¥ Ø£Ø³Ø±Ø¹ Ø´Ø­Ù† Ø¨Ø¶Ù…Ø§Ù† Ø§Ù„Ø¬ÙˆØ¯Ø©!</span>
  </div>
</div>

<!-- Products & Ads -->
<main class="p-4 max-w-2xl mx-auto space-y-6">
  <section>
    <h2 class="font-black text-slate-800 text-lg mb-4">Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø´Ø­Ù† Ø§Ù„Ø³Ø±ÙŠØ¹</h2>
    <div id="products-list" class="grid gap-4"></div>
  </section>
  <section>
    <h2 class="font-black text-slate-800 text-lg mb-4">Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø­ØµØ±ÙŠØ©</h2>
    <div class="grid gap-4">
      <div class="ad-card">ğŸ’ Ø¹Ø±Ø¶ VIP: Ø§Ø´Ø­Ù† 1000 Ø¬.Ø³ ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ 50 Ø´Ø¯Ø© Ù…Ø¬Ø§Ù†ÙŠØ©!</div>
      <div class="ad-card">ğŸ”¥ Ø£Ø³Ø±Ø¹ Ø´Ø­Ù† Ø¨Ø¶Ù…Ø§Ù† Ø¬ÙˆØ¯Ø© KHASM SHOP!</div>
      <div class="ad-card">ğŸ Ø§Ø´Ø­Ù† Ø§Ù„Ø¢Ù† ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø· Ø¥Ø¶Ø§ÙÙŠØ©!</div>
      <div class="ad-card">ğŸš€ Ø®ØµÙ… 10% Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø­Ù†Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© Ø§Ù„ÙŠÙˆÙ…!</div>
      <div class="ad-card">ğŸ‰ Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø· Ù…Ø¶Ø§Ø¹ÙØ© Ù„Ù…Ø¯Ø© 24 Ø³Ø§Ø¹Ø©!</div>
    </div>
  </section>

  <section id="admin-section" class="hidden mt-10 p-6 bg-slate-900 rounded-[30px] text-white">
    <h2 class="font-black text-xl mb-4 text-red-400">Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</h2>
    <div id="all-orders-list" class="space-y-4"></div>
  </section>
</main>

<!-- Modal Request Details -->
<div id="request-modal">
  <div class="modal-content">
    <h3 class="font-black text-lg mb-2">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨</h3>
    <div id="modal-details"></div>
    <button onclick="closeModal()" class="mt-4 bg-red-500 text-white py-2 rounded-xl w-full">Ø¥ØºÙ„Ø§Ù‚</button>
  </div>
</div>

<script type="module">
// Firebase Imports
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signInWithPhoneNumber, RecaptchaVerifier } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
import { getFirestore, collection, addDoc, deleteDoc, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

const firebaseConfig = { apiKey:"API_KEY", authDomain:"ID.firebaseapp.com", projectId:"ID" };
const ADMIN_UID = "hFeFMyTjzLd8nAEDuZ784VXNYln2";

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Splash
setTimeout(()=>{
  document.getElementById('splash-screen').style.opacity='0';
  setTimeout(()=>{document.getElementById('splash-screen').style.display='none'; checkAuth();},1000)
},3000);

function checkAuth(){
  onAuthStateChanged(auth,user=>{
    if(!user){document.getElementById('auth-page').classList.remove('hidden');}
    else{
      document.getElementById('auth-page').classList.add('hidden');
      document.getElementById('userPhone').innerText=user.phoneNumber||'-';
      loadProducts(); loadOrders(); loadRedeemPoints();
    }
  });
}

window.loginWithGoogle=async()=>{const provider=new GoogleAuthProvider(); await signInWithPopup(auth,provider);}
window.showPhoneLogin=()=>{
  const phone=prompt("Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ Ø¨Ø§Ù„Ø³ÙˆØ¯Ø§Ù†")?.trim();
  if(phone){
    const recaptcha=new RecaptchaVerifier('auth-page',{'size':'invisible'},auth);
    const phoneNumber='+249'+phone;
    signInWithPhoneNumber(auth,phoneNumber,recaptcha).then(confirmationResult=>{
      const code=prompt("Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ OTP").trim();
      confirmationResult.confirm(code).then(()=>{alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„!');}).catch(()=>{alert('Ø®Ø·Ø£ Ø¨Ø§Ù„ÙƒÙˆØ¯');});
    }).catch(()=>{alert('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ OTP');});
  }
}
window.logout=()=>{auth.signOut(); location.reload();}

// Sidebar
function openSidebar(){document.getElementById('sidebar').classList.add('show');}
function closeSidebar(){document.getElementById('sidebar').classList.remove('show');}

// Modal
function showModal(details){
  document.getElementById('modal-details').innerHTML=details;
  document.getElementById('request-modal').style.display='flex';
}
function closeModal(){document.getElementById('request-modal').style.display='none';}

// Products
function loadProducts(){
  const products=[
    {name:"60 Ø´Ø¯Ø©",points:2,value:"1000 Ø¬.Ø³"},
    {name:"120 Ø´Ø¯Ø©",points:4,value:"2000 Ø¬.Ø³"},
    {name:"180 Ø´Ø¯Ø©",points:6,value:"3000 Ø¬.Ø³"},
    {name:"240 Ø´Ø¯Ø©",points:8,value:"4000 Ø¬.Ø³"},
    {name:"4000 Ø¬.Ø³",points:30,value:"4000 Ø¬.Ø³"}
  ];
  const container=document.getElementById('products-list'); container.innerHTML='';
  products.forEach(p=>{
    const card=document.createElement('div');
    card.className='royal-card p-4 flex justify-between items-center';
    card.innerHTML=`<div>
      <p class="font-bold">${p.name}</p>
      <p class="text-xs text-slate-400">Ù†Ù‚Ø§Ø·: ${p.points}</p>
      <p class="text-xs text-slate-300">Ø§Ù„Ø³Ø¹Ø±: ${p.value}</p>
    </div>`;
    card.onclick=()=>{showModal(`<p>${p.name}</p><p>Ù†Ù‚Ø§Ø·: ${p.points}</p><p>Ø§Ù„Ø³Ø¹Ø±: ${p.value}</p>`);}
    container.appendChild(card);
  });
}

// Orders (Admin)
function loadOrders(){
  const adminCont=document.getElementById('all-orders-list');
  onSnapshot(collection(db,"orders"),snap=>{
    adminCont.innerHTML='';
    snap.forEach(d=>{
      const o=d.data();
      adminCont.innerHTML+=`<div class="bg-white/5 p-4 rounded-2xl flex justify-between items-center border border-white/10 cursor-pointer hover:bg-white/10">
        <div><p class="font-bold">${o.userName}</p><p class="text-xs text-slate-400">${o.productName}</p><p class="text-xs text-green-400">${o.status||'Ø¬Ø¯ÙŠØ¯'}</p></div>
        <button onclick="deleteOrder('${d.id}')" class="bg-red-500/20 text-red-500 p-2 rounded-xl"><i class="fas fa-trash"></i></button>
      </div>`;
    });
  });
}
window.deleteOrder=async(id)=>{if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ØŸ")){await deleteDoc(doc(db,"orders",id));alert("ØªÙ… Ø§Ù„Ø­Ø°Ù.");}}

// Redeem Points
function loadRedeemPoints(){
  const container=document.getElementById('redeemPoints');
  const items=[
    {name:"60 Ø´Ø¯Ø©",points:30,value:"4000 Ø¬.Ø³"},
    {name:"120 Ø´Ø¯Ø©",points:30,value:"4000 Ø¬.Ø³"},
    {name:"180 Ø´Ø¯Ø©",points:30,value:"4000 Ø¬.Ø³"}
  ];
  container.innerHTML='';
  items.forEach(i=>{
    const div=document.createElement('div');
    div.className='bg-white/5 p-3 rounded-xl flex justify-between cursor-pointer hover:bg-white/10';
    div.innerHTML=`<span>${i.name}</span><span>${i.value} - ${i.points} Ù†Ù‚Ø§Ø·</span>`;
    div.onclick=()=>{showModal(`<p>${i.name}</p><p>Ù†Ù‚Ø§Ø·: ${i.points}</p><p>Ø§Ù„Ø³Ø¹Ø±: ${i.value}</p>`);}
    container.appendChild(div);
  });
}
</script>
</body>
  </html>
