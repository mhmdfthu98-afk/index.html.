<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø§Ù„Ø®ØµÙ… | KHASM SHOP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; background-color: #020617; color: white; margin: 0; padding: 0; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .admin-panel { display: none; border: 2px solid #dc2626; background: rgba(220, 38, 38, 0.05); }
        .glow-red { box-shadow: 0 0 20px rgba(220, 38, 38, 0.4); }
        .product-card { transition: all 0.3s ease; border: 1px solid rgba(255,255,255,0.05); }
        .product-card:hover { transform: translateY(-10px); border-color: #dc2626; }
    </style>
</head>
<body class="p-4">

    <header class="text-center py-10">
        <h1 class="text-6xl font-black text-red-600 tracking-tighter italic uppercase drop-shadow-2xl">KHASM SHOP</h1>
        <p class="text-gray-400 mt-2 font-bold tracking-widest text-sm">EMPIRE OF UC - SUDAN ğŸ‡¸ğŸ‡©</p>
    </header>

    <div id="adminPanel" class="admin-panel glass p-6 rounded-[2rem] mb-10 glow-red max-w-2xl mx-auto">
        <h2 class="text-red-500 font-black mb-6 text-center text-2xl uppercase tracking-tighter">Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªØ¬Ø± ğŸ‘‘</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <label class="block text-xs mb-1 mr-2 text-gray-400">ÙƒÙ…ÙŠØ© Ø§Ù„Ø´Ø¯Ø§Øª</label>
                <input id="ucAmount" type="number" placeholder="Ù…Ø«Ø§Ù„: 325" class="w-full p-4 rounded-2xl bg-black border border-gray-800 text-white focus:border-red-600 outline-none">
            </div>
            <div>
                <label class="block text-xs mb-1 mr-2 text-gray-400">Ø§Ù„Ø³Ø¹Ø± (Ø¬.Ø³)</label>
                <input id="ucPrice" type="number" placeholder="Ù…Ø«Ø§Ù„: 25000" class="w-full p-4 rounded-2xl bg-black border border-gray-800 text-white focus:border-red-600 outline-none">
            </div>
        </div>
        <button onclick="addProduct()" class="w-full bg-red-600 hover:bg-red-700 text-white font-black py-4 mt-6 rounded-2xl shadow-lg transition duration-300 uppercase italic">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø±Ø¶ Ù„Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø¢Ù† ğŸ”¥</button>
    </div>

    <div id="loginSection" class="text-center py-16 glass rounded-[3rem] max-w-md mx-auto border-red-600/20 shadow-2xl">
        <h3 class="text-3xl font-black italic mb-2">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ©</h3>
        <p class="text-gray-500 text-sm mb-8">Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ø¶Ù…Ø§Ù† ØªØ¬Ø±Ø¨Ø© Ø´Ø­Ù† Ø¢Ù…Ù†Ø©</p>
        <button onclick="login()" class="bg-white text-black font-black py-4 px-12 rounded-2xl shadow-2xl hover:scale-105 transition-all flex items-center justify-center mx-auto gap-3">
            <img src="https://www.google.com/favicon.ico" class="w-6 h-6"> Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Ø¬ÙˆØ¬Ù„
        </button>
    </div>

    <div id="productsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 mt-4 max-w-6xl mx-auto pb-20">
        </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø³Ø±ÙŠØ© Ø§Ù„Ù„ÙŠ Ø±Ø¨Ø·Ù†Ø§Ù‡Ø§
        const firebaseConfig = {
            apiKey: "AIzaSyC0jzecEwKgHpxHpTi8Y-_bwwfzVdtgf3E",
            authDomain: "khasmshop.firebaseapp.com",
            databaseURL: "https://khasmshop-default-rtdb.firebaseio.com",
            projectId: "khasmshop",
            storageBucket: "khasmshop.firebasestorage.app",
            messagingSenderId: "238182001615",
            appId: "1:238182001615:web:4c7ddea335df2111b440ba"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        const ADMIN_EMAIL = "mhmdfthu98@gmail.com";

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        window.login = () => {
            signInWithPopup(auth, provider).catch(err => {
                alert("ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙÙŠ Firebase Authorized Domains");
            });
        };

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('loginSection').style.display = 'none';
                if (user.email === ADMIN_EMAIL) {
                    document.getElementById('adminPanel').style.display = 'block';
                }
            }
        });

        // Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬
        window.addProduct = () => {
            const uc = document.getElementById('ucAmount').value;
            const price = document.getElementById('ucPrice').value;
            if (uc && price) {
                push(ref(db, 'products'), { uc, price });
                alert("ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­!");
                document.getElementById('ucAmount').value = '';
                document.getElementById('ucPrice').value = '';
            }
        };

        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        onValue(ref(db, 'products'), (snapshot) => {
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = '';
            snapshot.forEach((child) => {
                const data = child.val();
                grid.innerHTML += `
                    <div class="product-card glass p-8 rounded-[3rem] text-center relative overflow-hidden">
                        <div class="text-xs font-black text-red-500 mb-2 tracking-tighter uppercase italic">Original UC</div>
                        <h3 class="text-6xl font-black mb-2 italic tracking-tighter">${data.uc}<span class="text-sm text-red-600 ml-1 italic font-normal">UC</span></h3>
                        <p class="text-xl text-gray-400 mb-8 font-bold tracking-widest">${data.price} <span class="text-[10px]">SDG</span></p>
                        <input type="number" id="id-${child.key}" placeholder="ID Ø§Ù„Ù„Ø§Ø¹Ø¨" class="w-full p-4 mb-4 rounded-2xl bg-white/5 border border-white/10 text-center font-bold outline-none focus:border-red-600">
                        <button onclick="orderNow('${data.uc}', '${data.price}', '${child.key}')" class="w-full bg-red-600 hover:bg-white hover:text-red-600 py-4 rounded-2xl font-black text-xl transition-all shadow-xl">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† âš¡</button>
                        ${auth.currentUser?.email === ADMIN_EMAIL ? `<button onclick="deleteItem('${child.key}')" class="mt-4 text-xs text-red-900 underline block mx-auto italic">Ø­Ø°Ù Ø§Ù„Ø¹Ø±Ø¶</button>` : ''}
                    </div>
                `;
            });
        });

        // Ø§Ù„Ø­Ø°Ù
        window.deleteItem = (key) => { if(confirm('Ø­Ø°ÙØŸ')) remove(ref(db, `products/${key}`)); };

        // Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨
        window.orderNow = (uc, price, key) => {
            const id = document.getElementById(`id-${key}`).value;
            if (!id) return alert("Ø§ÙƒØªØ¨ Ø§Ù„Ù€ ID ÙŠØ§ Ø¨Ø·Ù„!");
            const msg = `Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ± Ø§Ù„Ø®ØµÙ…ØŒ Ø£Ø±ÙŠØ¯ Ø´Ø­Ù† ${uc} Ø´Ø¯Ø© Ù„Ù„Ù€ ID: ${id}. Ø§Ù„Ø³Ø¹Ø±: ${price} Ø¬.Ø³`;
            window.open(`https://wa.me/249916581517?text=${encodeURIComponent(msg)}`);
        };
    </script>
</body>
</html>
