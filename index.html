<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KHASM SHOP | Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø§Ù„Ø®ØµÙ… Ø§Ù„Ù…Ù„ÙƒÙŠØ©</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ù„ÙƒÙŠ */
        :root { 
            --neon: #22c55e; 
            --bg: #030303; 
            --gold: #f59e0b; 
            --glass: rgba(15, 23, 42, 0.7);
        }

        body { 
            font-family: 'Cairo', sans-serif; 
            background: var(--bg); 
            color: white; 
            overflow-x: hidden; 
            margin: 0; 
            padding: 0; 
            -webkit-tap-highlight-color: transparent; 
        }

        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¬Ù„Ø§Ø³ */
        .glass-card { 
            background: var(--glass); 
            backdrop-filter: blur(25px); 
            border-radius: 35px; 
            border: 1px solid rgba(255,255,255,0.08); 
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        }
        
        .glass-card:hover { transform: translateY(-5px); }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© */
        .khasm-btn { 
            background: linear-gradient(135deg, #16a34a, #065f46); 
            border-radius: 22px; 
            padding: 18px; 
            font-weight: 900; 
            text-align: center; 
            cursor: pointer; 
            color: white; 
            width: 100%; 
            border: none; 
            display: block; 
            box-shadow: 0 15px 35px rgba(22, 163, 74, 0.2); 
            transition: 0.3s;
        }

        .khasm-btn:active { transform: scale(0.96); opacity: 0.9; }

        /* Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ø±Ùƒ ÙˆØ§Ù„ØµÙØ­Ø§Øª */
        .page { display: none; animation: slideUp 0.6s cubic-bezier(0.23, 1, 0.32, 1); }
        .page.active { display: block; }
        
        @keyframes slideUp { 
            from { transform: translateY(40px); opacity: 0; } 
            to { transform: translateY(0); opacity: 1; } 
        }

        /* Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± Ø§Ù„Ù…ØªØ·ÙˆØ± */
        #slider-container { display: flex; transition: transform 0.8s cubic-bezier(0.7, 0, 0.3, 1); }
        .slide-item { min-width: 100%; padding: 0 20px; box-sizing: border-box; }
        .slide-box { 
            height: 180px; 
            border-radius: 45px; 
            padding: 2.5rem; 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            position: relative; 
            overflow: hidden; 
        }
        
        .dot { width: 8px; height: 8px; background: #333; border-radius: 50%; transition: 0.4s; }
        .dot.active { width: 30px; background: var(--neon); border-radius: 20px; }

        /* Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª ÙˆØ§Ù„Ù‚ÙˆØ§Ø¦Ù… */
        input, select { 
            background: rgba(255,255,255,0.03) !important; 
            color: white !important; 
            border: 1px solid rgba(255,255,255,0.1) !important; 
            border-radius: 18px; 
            padding: 15px;
            transition: 0.3s; 
            outline: none;
        }
        
        input:focus, select:focus { border-color: var(--neon) !important; background: rgba(255,255,255,0.06) !important; }

        nav button.active { color: var(--neon); transform: translateY(-8px); }
        
        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ø¨Ø¶ Ù„Ù„Ø­Ø§Ù„Ø§Øª */
        .pulse-orange { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
    </style>
</head>
<body>

    <div id="loginOverlay" class="fixed inset-0 bg-[#030303] z-[10000] flex flex-col items-center justify-center p-10 text-center">
        <div class="mb-12 scale-150">
            <h1 class="text-6xl font-black text-green-500 italic tracking-tighter">KHASM</h1>
            <p class="text-white tracking-[0.8em] text-[10px] font-bold mt-1 uppercase">Royal Shop</p>
        </div>
        <button id="loginBtn" class="w-full max-w-xs bg-white text-black py-6 rounded-full font-black flex items-center justify-center gap-4 shadow-[0_0_60px_rgba(255,255,255,0.1)] active:scale-90 transition-all">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/action/google.svg" width="24"> 
            Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ©
        </button>
        <p class="mt-8 text-gray-600 text-[10px] font-bold">Ø¨Ù…ØªØ§Ø¨Ø¹ØªÙƒ Ø£Ù†Øª ØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø´Ø±ÙˆØ· Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø§Ù„Ø®ØµÙ…</p>
    </div>

    <header class="p-6 sticky top-0 z-[5000] backdrop-blur-3xl border-b border-white/5 flex justify-between items-center">
        <div>
            <h2 class="text-2xl font-black text-green-500 italic">KHASM SHOP</h2>
            <div class="flex items-center gap-2 mt-1">
                <p id="userStatus" class="text-[9px] text-gray-500 font-bold uppercase tracking-tighter">Sudan Premium</p>
                <span class="w-1 h-1 bg-gray-700 rounded-full"></span>
                <button onclick="logout()" class="text-[9px] text-red-500 font-black">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>
        <div class="bg-amber-500/10 px-5 py-2 rounded-2xl border border-amber-500/20 flex items-center gap-2 shadow-inner">
            <span id="starsCount" class="text-xl font-black text-amber-500">0</span>
            <i class="fas fa-crown text-amber-500 text-xs"></i>
        </div>
    </header>

    <div class="relative max-w-lg mx-auto mt-8 overflow-hidden">
        <div id="slider-container">
            <div class="slide-item">
                <div class="slide-box bg-gradient-to-br from-green-600 to-black">
                    <div><h4 class="text-3xl font-black mb-1">Ø´Ø­Ù† ÙÙˆØ±ÙŠ âš¡</h4><p class="text-[11px] text-green-200 opacity-80">ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø£Ù‚Ù„ Ù…Ù† 5 Ø¯Ù‚Ø§Ø¦Ù‚</p></div>
                    <i class="fas fa-bolt text-8xl text-white/5 absolute -left-6 -bottom-6"></i>
                </div>
            </div>
            <div class="slide-item">
                <div class="slide-box bg-gradient-to-br from-amber-600 to-black">
                    <div><h4 class="text-3xl font-black mb-1">Ù‡Ø¯Ø§ÙŠØ§ Ø§Ù„Ù†Ø¬ÙˆÙ… âœ¨</h4><p class="text-[11px] text-amber-200 opacity-80">Ø§Ø³ØªØ¨Ø¯Ù„ Ù†Ø¬ÙˆÙ…Ùƒ Ø¨Ø¬ÙˆØ§Ø¦Ø² Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ø¢Ù†</p></div>
                    <i class="fas fa-gem text-8xl text-white/5 absolute -left-6 -bottom-6"></i>
                </div>
            </div>
        </div>
        <div class="flex justify-center gap-3 mt-6">
            <div class="dot active" id="d0"></div><div class="dot" id="d1"></div>
        </div>
    </div>

    <main class="p-6 max-w-lg mx-auto mb-32">
        
        <section id="page-shop" class="page active space-y-8">
            <div id="pkgs-list" class="space-y-8">
                </div>
        </section>

        <section id="page-orders" class="page space-y-6">
            <div class="flex items-center justify-between mb-2">
                <h3 class="text-xl font-black italic">Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠ</h3>
                <i class="fas fa-history text-gray-700"></i>
            </div>
            <div id="user-orders" class="space-y-4"></div>
        </section>

        <section id="page-admin" class="page space-y-8">
            <div class="glass-card p-6 border-green-500/20">
                <h3 class="font-black text-center text-green-500 mb-6 flex items-center justify-center gap-2">
                    <i class="fas fa-plus-circle"></i> Ø¥Ø¶Ø§ÙØ© Ø­Ø²Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©
                </h3>
                <div class="space-y-4">
                    <input id="add-a" type="number" placeholder="ÙƒÙ…ÙŠØ© Ø§Ù„Ø´Ø¯Ø§Øª (UC)" class="w-full">
                    <input id="add-p" type="number" placeholder="Ø§Ù„Ø³Ø¹Ø± (SDG)" class="w-full">
                    <button onclick="pushNewPkg()" class="khasm-btn">Ø§Ø¹ØªÙ…Ø§Ø¯ ÙÙŠ Ø§Ù„Ù…ØªØ¬Ø± âœ…</button>
                </div>
            </div>
            
            <div class="flex items-center justify-between mt-10">
                <h3 class="font-black italic">Ø¥Ø¯Ø§Ø±Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø²Ø¨Ø§Ø¦Ù†</h3>
                <span class="text-[10px] bg-red-500/10 text-red-500 px-3 py-1 rounded-full font-bold">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„ÙˆÙƒÙŠÙ„</span>
            </div>
            <div id="adm-orders-view" class="space-y-4"></div>
            
            <div class="mt-10">
                <h3 class="font-black italic mb-4">Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h3>
                <div id="adm-pkgs-list" class="space-y-3"></div>
            </div>
        </section>
    </main>

    <nav class="fixed bottom-6 inset-x-6 h-20 bg-black/80 backdrop-blur-3xl border border-white/10 rounded-[40px] flex justify-around items-center z-[8000] px-4 shadow-2xl">
        <button onclick="changePage('shop')" id="n-shop" class="flex flex-col items-center gap-1 text-[9px] font-black uppercase active transition-all">
            <i class="fas fa-shopping-bag text-xl"></i>Ø§Ù„Ù…ØªØ¬Ø±
        </button>
        <button onclick="changePage('orders')" id="n-orders" class="flex flex-col items-center gap-1 text-[9px] font-black uppercase transition-all">
            <i class="fas fa-bolt text-xl"></i>Ø·Ù„Ø¨Ø§ØªÙŠ
        </button>
        <button id="n-admin" onclick="changePage('admin')" class="hidden flex flex-col items-center gap-1 text-[9px] font-black uppercase text-red-500 transition-all">
            <i class="fas fa-shield-alt text-xl"></i>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        </button>
    </nav>

    <script type="module">
        // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…ÙƒØªØ¨Ø§Øª Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, remove, set, get, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        const fbConf = { 
            apiKey: "AIzaSyC0jzecEwKgHpxHpTi8Y-_bwwfzVdtgf3E", 
            authDomain: "khasmshop.firebaseapp.com", 
            databaseURL: "https://khasmshop-default-rtdb.firebaseio.com", 
            projectId: "khasmshop" 
        };
        
        const app = initializeApp(fbConf); 
        const db = getDatabase(app); 
        const auth = getAuth(app); 
        const provider = new GoogleAuthProvider();
        
        // Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙˆØ¯Ø§Ø¡ ÙˆØ§Ù„Ø¨ÙŠØ¶Ø§Ø¡ Ù„Ù„Ù…Ø¯Ø±Ø§Ø¡ ÙˆØ§Ù„ÙˆÙƒÙ„Ø§Ø¡
        const MASTER_ADMIN = "mhmdfthu98@gmail.com";
        const AGENTS = ["mohnadyasir43@gmail.com", "muhammedaltaj111@gmail.com"];
        let user = null;

        // ÙˆØ¸ÙŠÙØ© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        document.getElementById('loginBtn').onclick = () => {
            signInWithPopup(auth, provider).then(() => {
                console.log("Welcome to Empire");
            }).catch(err => alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: " + err.message));
        };

        // ÙˆØ¸ÙŠÙØ© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        window.logout = () => {
            if(confirm("Ù‡Ù„ ØªÙˆØ¯ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ©ØŸ")) {
                signOut(auth).then(() => location.reload());
            }
        };

        // Ù…Ø±Ø§Ù‚Ø¨ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        onAuthStateChanged(auth, u => {
            if(u) {
                user = u; 
                document.getElementById('loginOverlay').style.display='none';
                document.getElementById('userStatus').innerText = u.displayName;
                const email = u.email.toLowerCase();
                
                // ØªÙØ¹ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„Ù…Ø¯Ø±Ø§Ø¡ ÙÙ‚Ø·
                if(email === MASTER_ADMIN || AGENTS.includes(email)) {
                    document.getElementById('n-admin').classList.remove('hidden');
                }
                initSync();
            }
        });

        // Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª
        window.changePage = (id) => {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('page-'+id).classList.add('active');
            document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
            document.getElementById('n-'+id).classList.add('active');
            window.scrollTo(0,0);
        };

        // ÙˆØ¸ÙŠÙØ© Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ (Ù„Ù„Ù…Ø¯ÙŠØ±)
        window.pushNewPkg = () => {
            const a = document.getElementById('add-a').value;
            const p = document.getElementById('add-p').value;
            if(a && p) {
                push(ref(db, 'packages'), { amount: a, price: p })
                .then(() => {
                    document.getElementById('add-a').value = '';
                    document.getElementById('add-p').value = '';
                    alert("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø²Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­ ğŸ‘‘");
                });
            }
        };

        // ÙˆØ¸ÙŠÙØ© Ø­Ø°Ù Ù…Ù†ØªØ¬ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹
        window.deletePkg = (key) => {
            if(confirm("Ø­Ø°Ù Ø§Ù„Ø­Ø²Ù…Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ")) {
                remove(ref(db, `packages/${key}`));
            }
        };

        // ÙˆØ¸ÙŠÙØ© ØªØ£ÙƒÙŠØ¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ÙˆØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù†Ø¬ÙˆÙ…
        window.confirmOrder = (key, uid, amt) => {
            update(ref(db, `orders/${key}`), { status: 'âœ… Ù…ÙƒØªÙ…Ù„' });
            const sRef = ref(db, `users/${uid}/stars`);
            get(sRef).then(snap => {
                const currentStars = snap.val() || 0;
                set(sRef, currentStars + Math.floor(amt/30));
            });
        };

        // ÙˆØ¸ÙŠÙØ© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
        window.sendOrder = (amt, key) => {
            const pid = document.getElementById('pid-'+key).value;
            const agentSelect = document.getElementById('agent-'+key);
            const agentPhone = agentSelect.value;
            const agentName = agentSelect.options[agentSelect.selectedIndex].text;

            if(!pid || pid.length < 5) return alert("ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù€ ID");

            const orderInfo = {
                userName: user.displayName,
                userId: user.uid,
                amount: amt,
                pid: pid,
                agent: agentName,
                status: 'â³ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',
                date: new Date().toLocaleString('ar-EG')
            };

            push(ref(db, 'orders'), orderInfo).then(() => {
                const msg = `ğŸ‘‘ *Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø§Ù„Ø®ØµÙ…*\n*Ø§Ù„Ø²Ø¨ÙˆÙ†:* ${user.displayName}\n*Ø§Ù„ÙˆÙƒÙŠÙ„:* ${agentName}\n*Ø§Ù„Ø·Ù„Ø¨:* ${amt} UC\n*ID:* ${pid}\n\nâœ… ÙŠØ±Ø¬Ù‰ Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØ±Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¢Ù†.`;
                window.open(`https://wa.me/${agentPhone}?text=${encodeURIComponent(msg)}`);
            });
        };

        // Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­ÙŠØ©
        function initSync() {
            // Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ù…ØªØ¬Ø± ÙˆØ§Ù„Ø¥Ø¯Ø§Ø±Ø©
            onValue(ref(db, 'packages'), snap => {
                const list = document.getElementById('pkgs-list');
                const admList = document.getElementById('adm-pkgs-list');
                list.innerHTML = ''; admList.innerHTML = '';
                
                snap.forEach(child => {
                    const d = child.val();
                    const k = child.key;
                    
                    list.innerHTML += `
                    <div class="glass-card p-8 text-center border-b-8 border-green-600/20 relative overflow-hidden group">
                        <div class="absolute top-0 right-0 bg-green-500 text-black text-[10px] font-black px-4 py-1 rounded-bl-2xl">Ø¹Ø±ÙˆØ¶ Ù…Ù„ÙƒÙŠØ©</div>
                        <h3 class="text-5xl font-black italic mb-2">${d.amount} <span class="text-xs text-green-500">UC</span></h3>
                        <p class="text-3xl font-black mb-6">${d.price} <span class="text-[12px] opacity-50">SDG</span></p>
                        
                        <div class="text-right mb-4">
                            <label class="text-[10px] font-bold text-gray-500 mr-2">Ø§Ø®ØªØ± ÙˆÙƒÙŠÙ„ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ©:</label>
                            <select id="agent-${k}" class="w-full mt-1 font-bold text-amber-500">
                                <option value="249907760989">ğŸ‘‘ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù… Ù„Ù„Ù…ØªØ¬Ø±</option>
                                <option value="249914178935">ğŸ›¡ï¸ Ù…Ù‡Ù†Ø¯ ÙŠØ§Ø³Ø± Ø¨Ù„ÙˆÙ„Ù‡</option>
                                <option value="201550165993">ğŸ‡ªğŸ‡¬ Ù…Ø­Ù…Ø¯ ÙØªØ­ÙŠ Ø­Ù…Ø²Ù‡ (Ù…ØµØ±)</option>
                            </select>
                        </div>

                        <input id="pid-${k}" type="number" placeholder="Ø£Ø¯Ø®Ù„ ID Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù‡Ù†Ø§" class="w-full p-5 text-center mb-5 font-black text-lg">
                        <button onclick="sendOrder('${d.amount}','${k}')" class="khasm-btn">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„ÙˆÙƒÙŠÙ„ ğŸš€</button>
                    </div>`;

                    admList.innerHTML += `
                    <div class="flex justify-between p-4 bg-white/5 rounded-2xl items-center border border-white/5">
                        <span class="font-bold">${d.amount} UC - ${d.price} SDG</span>
                        <button onclick="deletePkg('${k}')" class="text-red-500 text-xs font-black bg-red-500/10 px-3 py-2 rounded-lg">Ø­Ø°Ù</button>
                    </div>`;
                });
            });

            // Ù…Ø²Ø§Ù…Ù†Ø© ØªØªØ¨Ø¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… + Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©)
            onValue(ref(db, 'orders'), snap => {
                const uOrders = document.getElementById('user-orders');
                const aOrders = document.getElementById('adm-orders-view');
                uOrders.innerHTML = ''; aOrders.innerHTML = '';
                
                snap.forEach(child => {
                    const v = child.val();
                    const k = child.key;
                    
                    if(v.userId === user.uid) {
                        const isDone = v.status.includes('Ù…ÙƒØªÙ…Ù„');
                        uOrders.innerHTML += `
                        <div class="glass-card p-6 border-r-4 ${isDone ? 'border-green-500' : 'border-amber-500'} bg-gradient-to-l from-white/5 to-transparent">
                            <div class="flex justify-between items-start">
                                <div>
                                    <span class="bg-white/10 px-3 py-1 rounded-lg text-[10px] font-black ${isDone ? 'text-green-500' : 'text-amber-500 pulse-orange'} mb-3 inline-block">
                                        <i class="fas ${isDone ? 'fa-check-double' : 'fa-spinner fa-spin'} mr-1"></i> ${v.status}
                                    </span>
                                    <h4 class="text-2xl font-black">${v.amount} UC</h4>
                                    <p class="text-[10px] text-gray-500 mt-1 font-bold italic">${v.date}</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-[10px] text-gray-500 mb-1">Ø§Ù„Ù…Ø¹Ø±Ù (ID)</p>
                                    <p class="text-sm font-black text-white bg-black/40 px-3 py-2 rounded-xl border border-white/5">${v.pid}</p>
                                </div>
                            </div>
                        </div>`;
                    }

                    if(user.email.toLowerCase() === MASTER_ADMIN || AGENTS.includes(user.email.toLowerCase())) {
                        aOrders.innerHTML += `
                        <div class="glass-card p-5 border-l-4 border-green-500">
                            <div class="flex justify-between items-center mb-3">
                                <span class="text-xs font-black text-green-500">ğŸ‘¤ ${v.userName}</span>
                                <span class="text-[9px] text-gray-500 italic">${v.date}</span>
                            </div>
                            <div class="bg-black/40 p-4 rounded-2xl text-sm font-bold mb-4">
                                <div class="flex justify-between"><span>Ø§Ù„Ø¢ÙŠØ¯ÙŠ:</span> <span class="text-green-400 select-all">${v.pid}</span></div>
                                <div class="flex justify-between mt-1"><span>Ø§Ù„ÙƒÙ…ÙŠØ©:</span> <span>${v.amount} UC</span></div>
                                <div class="flex justify-between mt-1 text-amber-500"><span>Ø§Ù„ÙˆÙƒÙŠÙ„:</span> <span>${v.agent}</span></div>
                            </div>
                            ${v.statu!== 'âœ… Ù…ÙƒØªÙ…Ù„' ? 
                                `<button onclick="confirmOrder('${k}','${v.userId}',${v.amount})" class="w-full bg-green-600 py-4 rounded-2xl font-black text-xs shadow-lg">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø´Ø­Ù† ÙˆØªØ³Ù„ÙŠÙ… Ø§Ù„Ù†Ø¬ÙˆÙ… âœ…</button>` : 
                                `<div class="text-center text-green-500 text-xs font-black py-3 bg-green-500/10 rounded-2xl">ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… Ø¨Ù†Ø¬Ø§Ø­</div>`}
                        </div>`;
                    }
                });
            });

            // Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ù†Ø¬ÙˆÙ…
            onValue(ref(db, `users/${user.uid}/stars`), snap => {
                document.getElementById('starsCount').innerText = snap.val() || 0;
            });
        }

        // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        let currentSlide = 0;
        setInterval(() => {
            currentSlide = (currentSlide + 1) % 2;
            const container = document.getElementById('slider-container');
            container.style.transform = `translateX(${currentSlide * 100}%)`;
            document.querySelectorAll('.dot').forEach((dot, idx) => {
                dot.classList.toggle('active', idx === currentSlide);
            });
        }, 5000);
    </script>
</body>
</html>
