<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KHASM SHOP | Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© ğŸ‘‘</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
:root { --main-bg: linear-gradient(135deg,#f8fafc 0%,#dbeafe 50%,#f1f5f9 100%); }
body { font-family:'Cairo',sans-serif; background:var(--main-bg); color:#1e293b; overflow-x:hidden; min-height:100vh; }

/* Splash Screen */
#splash-screen { position:fixed; inset:0; z-index:1000; background: radial-gradient(circle at center, #020617 0%, #000 100%); display:flex; flex-direction:column; align-items:center; justify-content:center; transition:opacity 1s ease; }
.loader-ring { width:120px; height:120px; border:4px solid transparent; border-top-color:#10b981; border-radius:50%; animation:spin 1s linear infinite; }
@keyframes spin { to { transform:rotate(360deg); } }

/* Cards */
.royal-card { background:rgba(255,255,255,0.8); backdrop-filter:blur(10px); border-radius:20px; box-shadow:0 10px 25px -5px rgba(0,0,0,0.05); padding:16px; display:flex; justify-content:space-between; align-items:center; }

/* News Slider */
.news-slider { background:#1e293b; color:#fff; padding:10px 0; overflow:hidden; position:relative; }
.news-track { display:flex; gap:50px; animation:scroll 25s linear infinite; white-space:nowrap; }
@keyframes scroll { 0% { transform:translateX(100%); } 100% { transform:translateX(-100%); } }

/* Buttons */
.btn-google { background:#fff; color:#444; border:1px solid #ddd; }
.btn-phone { background:#2563eb; color:#fff; }

/* Hamburger Sidebar */
#hamburger { position:fixed; top:20px; right:20px; width:35px; height:30px; display:flex; flex-direction:column; justify-content:space-between; cursor:pointer; z-index:600; }
#hamburger span { display:block; height:4px; background:#1e293b; border-radius:2px; }
#sidebar { position:fixed; top:0; right:0; width:0; height:100%; background:#fff; overflow-x:hidden; transition:0.3s; z-index:500; box-shadow:-3px 0 10px rgba(0,0,0,0.1); }
</style>
</head>
<body>

<!-- Splash Screen -->
<div id="splash-screen">
  <div class="loader-ring mb-6"></div>
  <h1 class="text-5xl font-black text-white animate-pulse">KHASM <span class="text-emerald-400">SHOP</span></h1>
  <p class="text-white/70 mt-2 font-bold tracking-widest text-sm">LOADING EMPIRE...</p>
</div>

<!-- Auth Page -->
<div id="auth-page" class="hidden fixed inset-0 bg-slate-900 flex items-center justify-center p-6 z-50">
  <div class="bg-white rounded-[40px] p-8 w-full max-w-md text-center shadow-2xl">
    <h2 class="text-2xl font-black text-slate-800 mb-4">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù„ÙƒÙŠ</h2>
    <button onclick="loginWithGoogle()" class="w-full btn-google py-4 rounded-2xl font-bold mb-4 flex items-center justify-center gap-3 shadow-sm">
      <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/action/google.svg" width="20">
      Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Google
    </button>
    <button onclick="showPhoneLogin()" class="w-full btn-phone py-4 rounded-2xl font-bold flex items-center justify-center gap-3 shadow-lg shadow-blue-200">
      <i class="fas fa-phone-alt"></i>
      Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (ÙˆØ§ØªØ³Ø§Ø¨)
    </button>
  </div>
</div>

<!-- News Slider -->
<div class="news-slider">
  <div class="news-track">
    <span>ğŸ”¥ Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±: Ø§Ø´Ø­Ù† 5000 Ø´Ø¯Ø© ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ 1000 Ù…Ø¬Ø§Ù†Ø§Ù‹!</span>
    <span>ğŸ’ Ø¬ÙˆØ§Ù‡Ø± ÙØ±ÙŠ ÙØ§ÙŠØ± Ù…ØªÙˆÙØ±Ø© Ø§Ù„Ø¢Ù† Ø¨Ø£Ø³Ø¹Ø§Ø± Ø³ÙˆØ¯Ø§Ù†ÙŠØ© Ø­ØµØ±ÙŠØ©!</span>
    <span>ğŸš€ Ø³Ø±Ø¹Ø© Ø§Ù„Ø´Ø­Ù† Ù„Ø§ ØªØªØ¬Ø§ÙˆØ² 5 Ø¯Ù‚Ø§Ø¦Ù‚!</span>
    <span>ğŸ Ø§Ø¬Ù…Ø¹ 30 Ù†Ù‚Ø·Ø© ÙˆØ§Ø³ØªØ¨Ø¯Ù„Ù‡Ø§ Ø¨Ù€ 4000 Ø¬Ù†ÙŠÙ‡!</span>
    <span>âš ï¸ ØªØ£ÙƒØ¯ Ù…Ù† ID Ù‚Ø¨Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨!</span>
  </div>
</div>

<!-- Header -->
<header class="p-6 flex justify-between items-center bg-white/50 backdrop-blur-md">
  <div class="flex items-center gap-3">
    <div id="userImg" class="w-10 h-10 bg-slate-200 rounded-full overflow-hidden"></div>
    <div>
      <h1 id="userName" class="font-black text-slate-800 leading-none">Ø§Ù„Ù…Ù„Ùƒ Ø§Ù„Ø²Ø§Ø¦Ø±</h1>
      <span class="text-[10px] text-blue-600 font-bold">Ø±ØµÙŠØ¯Ùƒ: <span id="userPoints">0</span> Ù†Ù‚Ø·Ø©</span>
    </div>
  </div>
  <div class="flex gap-2 text-slate-400">
    <i class="fas fa-bell"></i>
    <i class="fas fa-cog"></i>
  </div>
</header>

<!-- Main Content -->
<main class="p-4 max-w-3xl mx-auto space-y-6">
  <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬..." class="mb-4 p-3 rounded-lg border border-gray-300 w-full">
  <section>
    <h2 class="font-black text-slate-800 text-lg mb-4">Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø´Ø­Ù† Ø§Ù„Ø³Ø±ÙŠØ¹</h2>
    <div id="products-list" class="grid gap-4"></div>
  </section>

  <section id="rewards-section" class="mt-10 p-6 bg-yellow-100 rounded-2xl">
    <h2 class="font-black text-xl mb-4 text-yellow-800">ğŸ’° Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ù†Ù‚Ø§Ø·</h2>
    <div id="rewards-list" class="grid gap-4"></div>
  </section>

  <section id="admin-section" class="hidden mt-10 p-6 bg-slate-900 rounded-2xl text-white">
    <h2 class="font-black text-xl mb-4 text-red-400">ğŸ‘‘ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ©</h2>
    <div id="all-orders-list" class="space-y-4"></div>
  </section>
</main>

<!-- Hamburger -->
<div id="hamburger">
  <span></span>
  <span></span>
  <span></span>
</div>

<!-- Sidebar -->
<div id="sidebar">
  <div class="p-6 flex flex-col h-full justify-between">
    <div>
      <div class="mb-6">
        <h2 class="font-black text-lg mb-2">Ø­Ø³Ø§Ø¨Ùƒ</h2>
        <p id="sidebarUserName" class="font-bold text-slate-800"></p>
        <p id="sidebarUserPhone" class="text-sm text-slate-500"></p>
        <span class="text-[10px] text-blue-600 font-bold">Ø±ØµÙŠØ¯Ùƒ: <span id="sidebarUserPoints">0</span> Ù†Ù‚Ø·Ø©</span>
      </div>
      <div class="mb-6">
        <h2 class="font-black text-lg mb-2">Ø·Ù„Ø¨Ø§ØªÙŠ</h2>
        <div id="sidebarOrders" class="space-y-2 max-h-60 overflow-y-auto"></div>
      </div>
      <div class="mb-6">
        <h2 class="font-black text-lg mb-2">Ù…Ù† Ù†Ø­Ù†</h2>
        <div id="aboutSection" class="text-sm text-slate-700 leading-relaxed">
          Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ… ÙÙŠ KHASM SHOP Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠØ© Ø§Ù„Ù…Ù„ÙƒÙŠØ© Ù„Ù„Ø´Ø­Ù† Ø§Ù„Ø³Ø±ÙŠØ¹ âš¡ğŸ”¥. Ù†Ù‚Ø¯Ù… Ø£ÙØ¶Ù„ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø´Ø­Ù† Ø¨Ø£Ù…Ø§Ù† ÙˆØ³Ø±Ø¹Ø© Ù…Ø¹ Ø¹Ø±ÙˆØ¶ Ù…Ø³ØªÙ…Ø±Ø© ÙˆÙ†Ù‚Ø§Ø· Ù…ÙƒØ§ÙØ¢Øª.ğŸ’ğŸš€
        </div>
      </div>
    </div>
    <div class="flex flex-col gap-2">
      <button onclick="switchAccount()" class="btn btn-phone w-full">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨</button>
      <button onclick="logoutUser()" class="btn btn-google w-full">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
    </div>
  </div>
</div>

<!-- Scripts -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
import { getFirestore, collection, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

// Ø¶Ø¹ Ù‡Ù†Ø§ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ù† Firebase
const firebaseConfig = {
  apiKey:"API_KEY",
  authDomain:"YOUR_PROJECT_ID.firebaseapp.com",
  projectId:"YOUR_PROJECT_ID",
  storageBucket:"YOUR_PROJECT_ID.appspot.com",
  messagingSenderId:"SENDER_ID",
  appId:"APP_ID"
};

const ADMIN_UID = "hFeFMyTjzLd8nAEDuZ784VXNYln2";

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Splash Screen
setTimeout(()=>{
  document.getElementById('splash-screen').style.opacity='0';
  setTimeout(()=>{ document.getElementById('splash-screen').style.display='none'; document.getElementById('auth-page').classList.remove('hidden'); },1000);
},3500);

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
window.loginWithGoogle = async ()=>{ const provider=new GoogleAuthProvider(); await signInWithPopup(auth,provider); };
window.showPhoneLogin = ()=>{ const phone=prompt("Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ:"); if(phone){ window.open(`https://wa.me/249XXXXXXXXX?text=Ø£Ø±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø±Ù‚Ù…ÙŠ: ${phone}`); alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ù„ØªØ£ÙƒÙŠØ¯ Ù‡ÙˆÙŠØªÙƒ!"); } };

// Hamburger
const hamburger = document.getElementById('hamburger');
const sidebar = document.getElementById('sidebar');
hamburger.addEventListener('click',()=>{ sidebar.style.width = sidebar.style.width==='300px'?'0':'300px'; });

// Logout + Switch Account
function logoutUser(){ auth.signOut().then(()=>{ alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬'); location.reload(); }); }
function switchAccount(){ logoutUser(); }

// Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª + Ø§Ù„Ù†Ù‚Ø§Ø·
const products = [
  { name:"Ø´Ø¯Ø© 60", points:2, price:30 },
  { name:"Ø´Ø¯Ø© 120", points:4, price:60 },
  { name:"Ø´Ø¯Ø© 180", points:6, price:90 },
  { name:"Ø´Ø¯Ø© 240", points:8, price:120 },
  { name:"Ø´Ø¯Ø© 300", points:10, price:150 },
  { name:"Ø´Ø¯Ø© 500", points:16, price:250 }
];

function loadProducts(){ 
  const container=document.getElementById("products-list"); 
  container.innerHTML=""; 
  products.forEach(p=>{
    const div=document.createElement("div"); 
    div.className="p-4 rounded-2xl bg-white/80 backdrop-blur-md shadow-lg flex justify-between items-center"; 
    div.innerHTML=`<div><h3 class="font-bold text-slate-800">${p.name}</h3><p class="text-sm text-slate-500">ØªÙƒØ³Ø¨ Ù†Ù‚Ø§Ø·: <span class="font-bold">${p.points}</span></p></div><button class="btn btn-phone" onclick="buyProduct('${p.name}',${p.points},${p.price})">Ø§Ø´Ø­Ù† Ø§Ù„Ø¢Ù†</button>`; 
    container.appendChild(div); 
  }); 
}

window.buyProduct = async(name,points,price)=>{ 
  const user=auth.currentUser; 
  if(!user) return alert("ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹!"); 
  try{ 
    await addDoc(collection(db,"orders"),{ productName:name, pointsEarned:points, price:price, userId:user.uid, userName:user.displayName, status:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°", createdAt:new Date() }); 
    alert(`ØªÙ… Ø´Ø±Ø§Ø¡ ${name} Ø¨Ù†Ø¬Ø§Ø­!\nØ§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…ÙƒØªØ³Ø¨Ø©: ${points}`); 
  } catch(err){ console.error(err); alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø´Ø­Ù†."); } 
};

// Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ù†Ù‚Ø§Ø·
const rewards = [
  { desc:"60 Ø´Ø¯Ø©", pointsNeeded:30, price:4000 },
  { desc:"120 Ø´Ø¯Ø©", pointsNeeded:60, price:8000 },
  { desc:"180 Ø´Ø¯Ø©", pointsNeeded:90, price:12000 },
  { desc:"300 Ø´Ø¯Ø©", pointsNeeded:150, price:20000 }
];

function loadRewards(){ 
  const container=document.getElementById("rewards-list"); 
  container.innerHTML=""; 
  rewards.forEach(r=>{
    const div=document.createElement("div"); 
    div.className="p-4 bg-yellow-50 rounded-xl flex justify-between items-center shadow-md"; 
    div.innerHTML=`<div><h4 class="font-bold text-yellow-800">${r.desc}</h4><p class="text-sm text-yellow-600">Ù†Ù‚Ø§Ø· Ù…Ø·Ù„ÙˆØ¨Ø©: <span class="font-bold">${r.pointsNeeded}</span></p></div><span class="font-black text-yellow-900">${r.price} Ø¬.Ø³</span>`; 
    container.appendChild(div); 
  }); 
}

// Ø§Ù„Ø¨Ø­Ø«
document.getElementById("searchInput").addEventListener("input",(e)=>{ 
  const term=e.target.value.toLowerCase(); 
  const filtered=products.filter(p=>p.name.toLowerCase().includes(term)); 
  const container=document.getElementById("products-list"); 
  container.innerHTML=""; 
  filtered.forEach(p=>{
    const div=document.createElement("div"); 
    div.className="p-4 rounded-2xl bg-white/80 backdrop-blur-md shadow-lg flex justify-between items-center"; 
    div.innerHTML=`<div><h3 class="font-bold text-slate-800">${p.name}</h3><p class="text-sm text-slate-500">ØªÙƒØ³Ø¨ Ù†Ù‚Ø§Ø·: <span class="font-bold">${p.points}</span></p></div><button class="btn btn-phone" onclick="buyProduct('${p.name}',${p.points},${p.price})">Ø§Ø´Ø­Ù† Ø§Ù„Ø¢Ù†</button>`; 
    container.appendChild(div); 
  }); 
});

// Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
onAuthStateChanged(auth,user=>{
  if(!user){ document.getElementById('auth-page').classList.remove('hidden'); }
  else{
    document.getElementById('auth-page').classList.add('hidden');
    document.getElementById('userName').innerText=user.displayName;
    document.getElementById('userImg').innerHTML=`<img src="${user.photoURL}" class="w-full h-full object-cover">`;
    if(user.uid===ADMIN_UID) document.getElementById('admin-section').classList.remove('hidden');
    loadSidebar(user);
    loadProducts(); loadRewards();
  }
});

function loadSidebar(user){
  document.getElementById('sidebarUserName').innerText=user.displayName;
  document.getElementById('sidebarUserPhone').innerText=user.phoneNumber||"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ù‚Ù… Ù…Ø³Ø¬Ù„";
  document.getElementById('sidebarUserPoints').innerText=document.getElementById('userPoints').innerText;
  const ordersContainer=document.getElementById('sidebarOrders'); ordersContainer.innerHTML="";
  onSnapshot(collection(db,"orders"),snap=>{
    snap.forEach(d=>{
      const o=d.data();
      if(o.userId===user.uid){
        const div=document.createElement('div');
        div.className="bg-gray-100 p-2 rounded-md flex justify-between items-center cursor-pointer hover:bg-gray-200";
        div.innerHTML=`<span>${o.productName}</span><span class="text-xs text-slate-500">${o.status}</span>`;
        div.onclick=()=>{ alert(`ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨:\nØ§Ù„Ù…Ù†ØªØ¬: ${o.productName}\nØ§Ù„Ø­Ø§Ù„Ø©: ${o.status}\nØ§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…ÙƒØªØ³Ø¨Ø©: ${o.pointsEarned}`); };
        ordersContainer.appendChild(div);
      }
    });
  });
}
</script>

</body>
          </html>
